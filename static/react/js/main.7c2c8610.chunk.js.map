{"version":3,"sources":["App.js","reportWebVitals.js","index.js"],"names":["ambientLight","AmbientLight","color","intensity","pointLight","PointLight","position","DEFAULT_THEME","buildingColor","trailColor0","trailColor1","trailColor2","trailColor3","trailColor4","trailColor5","material","ambient","diffuse","shininess","specularColor","effects","LightingEffect","INITIAL_VIEW_STATE","longitude","latitude","zoom","pitch","bearing","App","buildings","BUILDINGS","trips","TRIPS","waiting_passengers","WAITING_PASSENGERS","waiting_vehicles","WAITING_VEHICLES","trailLength","initialViewState","mapStyle","theme","loopLength","LOOP_LENGTH","startingAnimationSpeed","animation_speed","useState","animationSpeed","setAnimationSpeed","console","log","time","setTime","period","$","css","hours","Math","floor","minutes","seconds","display_time","text","updateTime","num_active_vehicles","METRIC_ANIMATIONS","num_active_passengers","avo","passengers_left","html","toFixed","toString","updateMetricAnimations","animation","animate","t","id","window","requestAnimationFrame","useEffect","cancelAnimationFrame","trailColors","layers","TripsLayer","data","getPath","d","path","getTimestamps","timestamps","getColor","vendor","opacity","widthMinPixels","rounded","currentTime","shadowEnabled","PolygonLayer","extruded","wireframe","getPolygon","f","polygon","getElevation","height","getFillColor","TextLayer","getPosition","coordinates","getText","number","getSize","getTextAnchor","getAlignmentBaseline","getPixelOffset","parameters","depthTest","style","zIndex","onClick","controller","reuseMaps","preventStyleDiffing","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"js/main.7c2c8610.chunk.js","sourcesContent":["/* global window */\nimport React, {useState, useEffect} from 'react';\nimport {render} from 'react-dom';\nimport {StaticMap} from 'react-map-gl';\nimport {AmbientLight, PointLight, LightingEffect} from '@deck.gl/core';\nimport DeckGL from '@deck.gl/react';\nimport {PolygonLayer, TextLayer} from '@deck.gl/layers';\nimport {TripsLayer} from '@deck.gl/geo-layers';\n\nfunction updateMetricAnimations(time) {\n  let num_active_vehicles = METRIC_ANIMATIONS[\"NumOfActiveVehicles\"][time];\n  let num_active_passengers = METRIC_ANIMATIONS[\"NumOfActivePassengers\"][time];\n  let avo = METRIC_ANIMATIONS[\"AVO\"][time];\n  let passengers_left = METRIC_ANIMATIONS[\"PassengersLeft\"][time];\n  $('#AVO').html(avo.toFixed(2).toString());\n  $('#NumOfActiveVehicles').html(num_active_vehicles.toString());\n  $('#NumOfActivePassengers').html(num_active_passengers.toString());\n  $('#PassengersLeft').html(passengers_left.toString());\n};\n\nfunction updateTime(time) {\n  var period = \"AM\";\n  if (time / 3600 >= 12) {\n    period = \"PM\";\n  }\n  if (time / 3600 <= 6 || time / 3600 >= 18) {\n    $('#time').css('background-color', 'black');\n    $('#time').css('color', 'white');\n  }\n  else {\n    $('#time').css('background-color', 'white');\n    $('#time').css('color', 'black');\n  }\n\n  var hours = Math.floor(time / 3600) % 12;\n  var minutes = Math.floor(time / 60) % 60;\n  var seconds = time % 60;\n\n  if (hours == 0) hours = 12;\n  hours = hours < 10 ? `0${hours}` : hours;\n  minutes = minutes < 10 ? `0${minutes}` : minutes;\n  seconds = seconds < 10 ? `0${seconds}` : seconds;\n\n  var display_time = `${hours}:${minutes}:${seconds} ${period}`;\n  $('#time').text(display_time);\n};\n\nconst ambientLight = new AmbientLight({\n  color: [255, 255, 255],\n  intensity: 1.0\n});\n\nconst pointLight = new PointLight({\n  color: [255, 255, 255],\n  intensity: 2.0,\n  position: [-74.762758, 40.226667, 8000]\n});\n\nconst lightingEffect = new LightingEffect({ambientLight, pointLight});\n\nconst material = {\n  ambient: 0.1,\n  diffuse: 0.6,\n  shininess: 32,\n  specularColor: [60, 64, 70]\n};\n\nconst DEFAULT_THEME = {\n  buildingColor: [175, 175, 175], // gray\n  trailColor0: [255, 0, 0], // red\n  trailColor1: [173, 216, 230], // lightblue\n  trailColor2: [0, 0, 139], // dark blue\n  trailColor3: [144, 238, 144], // light green\n  trailColor4: [0, 100, 0], // dark green\n  trailColor5: [0, 0, 0], // black -> Passenger waited too long and left depot\n  material,\n  effects: [lightingEffect]\n};\n\nconst INITIAL_VIEW_STATE = {\n  longitude: -74.762758,\n  latitude: 40.226667,\n  zoom: 12,\n  pitch: 45,\n  bearing: 0\n};\n\nconst MAP_STYLE = 'https://basemaps.cartocdn.com/gl/positron-gl-style/style.json';\n\nfunction App({\n  buildings = BUILDINGS,\n  trips = TRIPS,\n  waiting_passengers = WAITING_PASSENGERS,\n  waiting_vehicles = WAITING_VEHICLES,\n  trailLength = 5,\n  initialViewState = INITIAL_VIEW_STATE,\n  mapStyle = MAP_STYLE,\n  theme = DEFAULT_THEME,\n  loopLength = LOOP_LENGTH, // unit corresponds to the timestamp in source data\n  startingAnimationSpeed = animation_speed\n}) {\n  const [animationSpeed, setAnimationSpeed] = useState(startingAnimationSpeed);\n  console.log(animationSpeed);\n  const [time, setTime] = useState(0);\n  updateTime(time);\n  updateMetricAnimations(time);\n  const [animation] = useState({});\n\n  const animate = () => {\n    setTime(t => (t + animationSpeed) % loopLength);\n    animation.id = window.requestAnimationFrame(animate);\n  };\n\n  useEffect(\n    () => {\n      animation.id = window.requestAnimationFrame(animate);\n      return () => window.cancelAnimationFrame(animation.id);\n    },\n    [animation]\n  );\n\n  const trailColors = [theme.trailColor0, theme.trailColor1, theme.trailColor2, theme.trailColor3, theme.trailColor4, theme.trailColor5];\n  const layers = [\n    new TripsLayer({\n      id: 'trips',\n      data: trips,\n      getPath: d => d.path,\n      getTimestamps: d => d.timestamps,\n      getColor: d => trailColors[d.vendor],\n      opacity: 0.8,\n      widthMinPixels: 5,\n      rounded: true,\n      trailLength,\n      currentTime: time,\n\n      shadowEnabled: false\n    }),\n    new PolygonLayer({\n      id: 'buildings',\n      data: buildings,\n      extruded: true,\n      wireframe: false,\n      opacity: 0.5,\n      getPolygon: f => f.polygon,\n      getElevation: f => f.height,\n      getFillColor: theme.buildingColor,\n      material: theme.material\n    }),\n    new TextLayer({\n      id: 'waiting_passengers',\n      data: waiting_passengers[time],\n      getPosition: d => d.coordinates, // replace with static list of depot locations at some point\n      getText: d => d.number,\n      getSize: 20,\n      getColor: [255, 0, 0],\n      getTextAnchor: 'start',\n      getAlignmentBaseline: 'bottom',\n      getPixelOffset: [5, 5],\n      parameters: {depthTest: false}\n    }),\n    new TextLayer({\n      id: 'waiting_vehicles',\n      data: waiting_vehicles[time],\n      getPosition: d => d.coordinates, // replace with static list of depot locations at some point\n      getText: d => d.number,\n      getSize: 20,\n      getColor: [79, 130, 247],\n      getTextAnchor: 'end',\n      getAlignmentBaseline: 'bottom',\n      getPixelOffset: [-5, 5],\n      parameters: {depthTest: false}\n    })\n  ];\n\n  return (\n    <div>\n    <button style={{position: 'absolute', zIndex: '2'}} onClick={() => setAnimationSpeed(animationSpeed * 2)}>\n        Fast forward\n    </button>\n    <DeckGL\n      layers={layers}\n      effects={theme.effects}\n      initialViewState={initialViewState}\n      controller={true}\n    >\n      <StaticMap reuseMaps mapStyle={mapStyle} preventStyleDiffing={true} />\n    </DeckGL>\n    </div>\n  );\n};\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}