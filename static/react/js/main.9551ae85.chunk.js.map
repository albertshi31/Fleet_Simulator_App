{"version":3,"sources":["App.js","reportWebVitals.js","index.js"],"names":["ambientLight","AmbientLight","color","intensity","pointLight","PointLight","position","DEFAULT_THEME","buildingColor","trailColor0","trailColor1","trailColor2","trailColor3","trailColor4","trailColor5","material","ambient","diffuse","shininess","specularColor","effects","LightingEffect","INITIAL_VIEW_STATE","longitude","latitude","zoom","pitch","bearing","App","buildings","BUILDINGS","trips","TRIPS","waiting_passengers","WAITING_PASSENGERS","waiting_vehicles","WAITING_VEHICLES","trailLength","initialViewState","mapStyle","theme","loopLength","LOOP_LENGTH","animationSpeed","ANIMATION_SPEED","startTime","START_TIME","useState","time","setTime","period","$","css","hours","Math","floor","minutes","seconds","display_time","text","updateTime","num_active_vehicles","METRIC_ANIMATIONS","num_active_passengers","avo","passengers_left","html","toFixed","toString","updateMetricAnimations","animation","animate","t","id","window","requestAnimationFrame","useEffect","cancelAnimationFrame","depotLocations","trailColors","layers","TripsLayer","data","getPath","d","path","getTimestamps","timestamps","getColor","vendor","opacity","widthMinPixels","rounded","currentTime","shadowEnabled","PolygonLayer","extruded","wireframe","getPolygon","f","polygon","getElevation","height","getFillColor","TextLayer","getPosition","c","getText","n","getSize","getTextAnchor","getAlignmentBaseline","getPixelOffset","parameters","depthTest","style","left","top","zIndex","width","onClick","location","href","class","type","min","max","timeSelected","document","getElementById","value","controller","reuseMaps","preventStyleDiffing","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode"],"mappings":"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","file":"js/main.9551ae85.chunk.js","sourcesContent":["/* global window */\nimport React, {useState, useEffect} from 'react';\nimport {render} from 'react-dom';\nimport {StaticMap} from 'react-map-gl';\nimport {AmbientLight, PointLight, LightingEffect} from '@deck.gl/core';\nimport DeckGL from '@deck.gl/react';\nimport {PolygonLayer, TextLayer} from '@deck.gl/layers';\nimport {TripsLayer} from '@deck.gl/geo-layers';\n\nfunction updateMetricAnimations(time) {\n  let num_active_vehicles = METRIC_ANIMATIONS[\"NumOfActiveVehicles\"][time];\n  let num_active_passengers = METRIC_ANIMATIONS[\"NumOfActivePassengers\"][time];\n  let avo = METRIC_ANIMATIONS[\"AVO\"][time];\n  let passengers_left = METRIC_ANIMATIONS[\"PassengersLeft\"][time];\n  $('#AVO').html(avo.toFixed(2).toString());\n  $('#NumOfActiveVehicles').html(num_active_vehicles.toString());\n  $('#NumOfActivePassengers').html(num_active_passengers.toString());\n  $('#PassengersLeft').html(passengers_left.toString());\n};\n\nfunction updateTime(time) {\n  var period = \"AM\";\n  if (time / 3600 >= 12) {\n    period = \"PM\";\n  }\n  if (time / 3600 <= 6 || time / 3600 >= 18) {\n    $('#time').css('background-color', 'black');\n    $('#time').css('color', 'white');\n  }\n  else {\n    $('#time').css('background-color', 'white');\n    $('#time').css('color', 'black');\n  }\n\n  var hours = Math.floor(time / 3600) % 12;\n  var minutes = Math.floor(time / 60) % 60;\n  var seconds = time % 60;\n\n  if (hours == 0) hours = 12;\n  hours = hours < 10 ? `0${hours}` : hours;\n  minutes = minutes < 10 ? `0${minutes}` : minutes;\n  seconds = seconds < 10 ? `0${seconds}` : seconds;\n\n  var display_time = `${hours}:${minutes}:${seconds} ${period}`;\n  $('#time').text(display_time);\n};\n\nconst ambientLight = new AmbientLight({\n  color: [255, 255, 255],\n  intensity: 1.0\n});\n\nconst pointLight = new PointLight({\n  color: [255, 255, 255],\n  intensity: 2.0,\n  position: [-74.762758, 40.226667, 8000]\n});\n\nconst lightingEffect = new LightingEffect({ambientLight, pointLight});\n\nconst material = {\n  ambient: 0.1,\n  diffuse: 0.6,\n  shininess: 32,\n  specularColor: [60, 64, 70]\n};\n\nconst DEFAULT_THEME = {\n  buildingColor: [175, 175, 175], // gray\n  trailColor0: [255, 0, 0], // red\n  trailColor1: [173, 216, 230], // lightblue\n  trailColor2: [0, 0, 139], // dark blue\n  trailColor3: [144, 238, 144], // light green\n  trailColor4: [0, 100, 0], // dark green\n  trailColor5: [0, 0, 0], // black -> Passenger waited too long and left depot\n  material,\n  effects: [lightingEffect]\n};\n\nconst INITIAL_VIEW_STATE = {\n  longitude: -74.762758,\n  latitude: 40.226667,\n  zoom: 12,\n  pitch: 45,\n  bearing: 0\n};\n\nconst MAP_STYLE = 'https://basemaps.cartocdn.com/gl/positron-nolabels-gl-style/style.json';\n\nfunction App({\n  buildings = BUILDINGS,\n  trips = TRIPS,\n  waiting_passengers = WAITING_PASSENGERS,\n  waiting_vehicles = WAITING_VEHICLES,\n  trailLength = 15,\n  initialViewState = INITIAL_VIEW_STATE,\n  mapStyle = MAP_STYLE,\n  theme = DEFAULT_THEME,\n  loopLength = LOOP_LENGTH, // unit corresponds to the timestamp in source data\n  animationSpeed = ANIMATION_SPEED,\n  startTime = START_TIME\n}) {\n\n  const [time, setTime] = useState(startTime);\n  updateTime(time);\n  updateMetricAnimations(time);\n  const [animation] = useState({});\n\n  const animate = () => {\n    setTime(t => (t + animationSpeed) % loopLength);\n    animation.id = window.requestAnimationFrame(animate);\n  };\n\n  useEffect(\n    () => {\n      animation.id = window.requestAnimationFrame(animate);\n      return () => window.cancelAnimationFrame(animation.id);\n    },\n    [animation]\n  );\n\n  const depotLocations = [[-74.7961659355, 40.2573225184], [-74.7376353, 40.2096325996], [-74.7365560004, 40.2049442004], [-74.7385219074, 40.2022611843], [-74.7426864838, 40.2038359521], [-74.7446668987, 40.2066230058], [-74.7465944633, 40.1993091366], [-74.7480265061, 40.2104303162], [-74.7505364126, 40.2047297942], [-74.7504727864, 40.2002140791], [-74.7518840001, 40.1986588377], [-74.755661277, 40.2056889816], [-74.7576635025, 40.1976591962], [-74.7587885045, 40.2126131531], [-74.7615293049, 40.2074477068], [-74.761859907, 40.2043401875], [-74.734932536, 40.2169911691], [-74.7370159997, 40.2238808003], [-74.7425452787, 40.2295385842], [-74.7407666995, 40.2165242004], [-74.7414561954, 40.2121634917], [-74.7432870693, 40.2248157211], [-74.7423656535, 40.2198021342], [-74.748154744, 40.2156924937], [-74.7392115001, 40.2385422004], [-74.7416398003, 40.2329152998], [-74.7435337003, 40.2428287], [-74.7460721004, 40.2373463471], [-74.7521018624, 40.2435554], [-74.7496987996, 40.2293870998], [-74.7514298996, 40.2352332001], [-74.7512439996, 40.2239780002], [-74.7542796002, 40.2190475002], [-74.7539253887, 40.2105825681], [-74.7569956001, 40.2236366996], [-74.7584613215, 40.2298211467], [-74.7602839738, 40.2345399443], [-74.7615481001, 40.2277391], [-74.758984512, 40.2206847175], [-74.7638448998, 40.2147323998], [-74.7702942244, 40.2210936874], [-74.7732648922, 40.2241694689], [-74.7718024132, 40.235271129], [-74.7731734002, 40.2322579001], [-74.7773986004, 40.2295121996], [-74.778804303, 40.2370876168], [-74.7869060838, 40.2381973502], [-74.7916969269, 40.231672496], [-74.7932996941, 40.2422722129], [-74.7999188569, 40.2466836077], [-74.7896579151, 40.2522172286], [-74.7864479833, 40.2487596207], [-74.7802626865, 40.242385832], [-74.7745876733, 40.2381497606], [-74.7717776552, 40.2488241839], [-74.7617933974, 40.2451731526], [-74.7540253465, 40.2417532347], [-74.7813941689, 40.23214321892]];\n  const trailColors = [theme.trailColor0, theme.trailColor1, theme.trailColor2, theme.trailColor3, theme.trailColor4, theme.trailColor5];\n  const layers = [\n    new TripsLayer({\n      id: 'trips',\n      data: trips,\n      getPath: d => d.path,\n      getTimestamps: d => d.timestamps,\n      getColor: d => trailColors[d.vendor],\n      opacity: 0.8,\n      widthMinPixels: 10,\n      rounded: true,\n      trailLength,\n      currentTime: time,\n\n      shadowEnabled: false\n    }),\n    new PolygonLayer({\n      id: 'buildings',\n      data: buildings,\n      extruded: true,\n      wireframe: false,\n      opacity: 0.5,\n      getPolygon: f => f.polygon,\n      getElevation: f => f.height,\n      getFillColor: theme.buildingColor,\n      material: theme.material\n    }),\n    new TextLayer({\n      id: 'waiting_passengers',\n      data: waiting_passengers[time],\n      getPosition: d => depotLocations[d.c], // replace with static list of depot locations at some point\n      getText: d => d.n,\n      getSize: 20,\n      getColor: [255, 0, 0],\n      getTextAnchor: 'start',\n      getAlignmentBaseline: 'bottom',\n      getPixelOffset: [5, 5],\n      parameters: {depthTest: false}\n    }),\n    new TextLayer({\n      id: 'waiting_vehicles',\n      data: waiting_vehicles[time],\n      getPosition: d => depotLocations[d.c], // replace with static list of depot locations at some point\n      getText: d => d.n,\n      getSize: 20,\n      getColor: [79, 130, 247],\n      getTextAnchor: 'end',\n      getAlignmentBaseline: 'bottom',\n      getPixelOffset: [-5, 5],\n      parameters: {depthTest: false}\n    })\n  ];\n\n  return (\n    <div>\n    <div style={{left: '0px', top: '0px', position: 'absolute', zIndex: '2', width: '50%'}}>\n    <button onClick={() => {window.location.href='/animation?animation_speed='+animationSpeed;}}>\n        <i class=\"fas fa-redo\" />\n    </button>\n    <button onClick={() => {window.location.href='/animation?animation_speed=1&start_time='+startTime;}}>\n        1x Speed\n    </button>\n    <button onClick={() => {window.location.href='/animation?animation_speed=10&start_time='+startTime;}}>\n        10x Speed\n    </button>\n    <button onClick={() => {window.location.href='/animation?animation_speed=100&start_time='+startTime;}}>\n        100x Speed\n    </button>\n    <button onClick={() => {window.location.href='/animation?animation_speed='+animationSpeed+'&start_time=1000';}}>\n        Skip to 1000 seconds\n    </button>\n    <br />\n    <input type=\"range\" min=\"0\" max={loopLength} id=\"timeSelector\" />\n    <br />\n    <button onClick={() => {var timeSelected = document.getElementById(\"timeSelector\").value; window.location.href='/animation?animation_speed='+animationSpeed+'&start_time='+timeSelected;}}>\n        Skip to <span id=\"timeSelectedValue\"></span> seconds\n    </button>\n    </div>\n    <DeckGL\n      layers={layers}\n      effects={theme.effects}\n      initialViewState={initialViewState}\n      controller={true}\n    >\n      <StaticMap reuseMaps mapStyle={mapStyle} preventStyleDiffing={true} />\n    </DeckGL>\n    </div>\n  );\n};\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}